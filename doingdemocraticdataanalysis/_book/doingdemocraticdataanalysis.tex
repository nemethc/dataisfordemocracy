\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={Doing Democratic Data Analysis},
            pdfauthor={Corban Nemeth},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{long table}}{}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs}

\title{Doing Democratic Data Analysis}
\author{Corban Nemeth}
\date{2020-04-09}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\chapter*{Preface}\label{preface}
\addcontentsline{toc}{chapter}{Preface}

I believe that data, \emph{in the hands of public administrators and
policy analysts}\footnote{\emph{Not IT departments}}, has the power to
transform the way government works.

Big questions will, and should, be asked of big data--- the role of
government in regulating algorithmic bias, facial recognition, and
consumer data privacy is a vital conversation. However, these topics
should not detract or deter public administrators and policy analysts
from leaning into \textbf{small data} for decision-making purposes.

Public administrators and analysts who are data literate will be able to
make and inform better decisions while avoiding the pitfalls posed by
the latest technological trends. This book represents an opportunity for
public administrators and policy analysts to join their subject matter
expertise with foundation principles and practices of democratic data
analysis--- data analysis that is \textbf{transparent, relevant, and
grounded in the context of ethical and effective governance}.

\section*{Who is this guide for?}\label{who-is-this-guide-for}
\addcontentsline{toc}{section}{Who is this guide for?}

This guide is for:

\begin{itemize}
\tightlist
\item
  the budget analyst at the Department of Fish and Wildlife who has to
  compile a monthly report analyzing revenues,
\item
  the manager at the Department of Social and Health Services who is
  tracking inventory, and
\item
  the research analyst working for the state Legislature who wants to
  incorporate data into her work session on the latest policy debate.
\end{itemize}

\section*{What will I learn?}\label{what-will-i-learn}
\addcontentsline{toc}{section}{What will I learn?}

You will learn an opinionated framework for data analysis in public
sector organizations. By opinionated, I mean that I will teach you what
I think is the right way to do things given my own experience as a
public sector policy and data analyst. Your experience might differ--
and that's great. I hope that where you can use your experience in place
of mine, you do to the fullest extent. With that in mind, it is often
said that you have to know the rules to break them, so I will teach you
the ``rules'' as I understand them.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(cars)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00
\end{verbatim}

\chapter{Introduction}\label{intro}

\section{What is democratic data
analysis?}\label{what-is-democratic-data-analysis}

This is little-d democracy here, people. Not a guide to data analysis
for Democrats, but an approach to data that empowers the subject matter
experts within public organizations to do their best work.

\section{Do I need to be an Excel god before I
begin?}\label{do-i-need-to-be-an-excel-god-before-i-begin}

\textbf{No.}

\section{What tools should I use?}\label{what-tools-should-i-use}

This guide is written to be technology-agnostic and is not a tutorial on
specific tools. The changing nature of technology and the lag of state
agencies to pick up tools means that the principles outlined in this
book supersede specific technologies.

However, you should start somewhere. This guide will include examples in
both Excel and \texttt{R}. Government runs on Excel, so all of the
examples and exercises will be Excel compatible. If you are comfortable
with Excel\footnote{aka you use \texttt{vlookup}, \texttt{index(match)},
  pivot tables, or \emph{Get \& Transform} on a somewhat regular basis}
and want to challenge yourself, boost your resume, and become a data
wizard\footnote{For example, I used R to create this entire website}, I
would highly recommend learning \texttt{R}. This guide will wshow
examples on how to analyze data democratically using both tools, but
focusing on the principles and practices that are vital regardless of
technology. I will link to specific resources that provide more detailed
walk through's as necessary.

\section{How to use this book}\label{how-to-use-this-book}

\section{Quickstart Guide to Excel}\label{quickstart-guide-to-excel}

Get \& Transform and Data Model

\section{Quickstart Guide to R}\label{quickstart-guide-to-r}

I would \textbf{HIGHLY} recommend you take an afternoon to work through
Chapters 1, 2, and 3 of
``\href{https://rstudio-conf-2020.github.io/r-for-excel/index.html}{\emph{R
for Excel Users}}''. You will thank me later.

\section{How to Think about Democratic Data
Analysis}\label{how-to-think-about-democratic-data-analysis}

What is data analysis? It may be easier to start with what data analysis
isn't.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Data analysis isn't math in Excel or a set of specific calculations.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Calculations are great, but \texttt{a7\ +\ b8} in Excel is
  deterministic. It gives you one answer. This book is not interested in
  data analysis that gives you the right answer, because there is no
  such thing. There are many answers to many questions, depending on how
  those questions are asked and how the data is analyzed.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Data analysis isn't statistics.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Look, regressions are great, but that isn't the crux of this book.
  This book is about reading and telling the story of your data in a way
  that can complement expertise and experience to make better decisions.
  Statistics are often used as a cheap stand-in for domain expertise and
  are often abused in favor of trusting the analyst or administrator to
  back up their assumptions with both quantitative and qualitiative
  data.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Data analysis isn't research methods.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  No set of tools and practices can stand in for asking the right
  questions, and transforming data into information to answer that
  question. This book will give you the tools to work with your
  quantitative data to answer relevant questions, but all good analysis
  begins with a good question.
\end{itemize}

So what are the principles of democratic data analysis?

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Democratic data analysis gives power to the subject matter expert.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Working with your own data lets you answer your question, rather than
  outsource those questions to IT departments who don't have the context
  necessary to turn data into information.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Democratic data analysis is easily shared and reproduced.
\item
  Democratic data analysis is honest about its assumptions and
  limitations.
\item
  Democratic data analysis is structured to be easily understood and
  communicated.
\item
  Democratic data analysis is approached methodically.
\end{enumerate}

\section{Alternate Forms of Data
Analysis}\label{alternate-forms-of-data-analysis}

I want to contrast democratic data analysis with alternate forms of
analysis that I have seen in my time working in the public sector.

\subsection*{Oligarchic Data Analysis}\label{oligarchic-data-analysis}
\addcontentsline{toc}{subsection}{Oligarchic Data Analysis}

\begin{itemize}
\tightlist
\item
  small group of ``data people''
\end{itemize}

\subsection*{Monarchic Data Analysis}\label{monarchic-data-analysis}
\addcontentsline{toc}{subsection}{Monarchic Data Analysis}

\begin{itemize}
\tightlist
\item
  Spreadsheets created decades ago, patched as necessary, and owned by a
  single or small group of people. Very unnaproachable. Can't ask
  questions.
\end{itemize}

\subsection*{Dictitorial Data Analysis}\label{dictitorial-data-analysis}
\addcontentsline{toc}{subsection}{Dictitorial Data Analysis}

*Not reproducible, all hard-coded, can't ask questions,

\subsection*{Technocratic Data
Analysis}\label{technocratic-data-analysis}
\addcontentsline{toc}{subsection}{Technocratic Data Analysis}

*Excel workbooks straight from the depths of hell. Formulas on formulas
on macros.

\section{Principles of Democratic Data
Analysis}\label{principles-of-democratic-data-analysis}

\begin{itemize}
\tightlist
\item
  Think in terms of fields, not values
\item
  Leave breadcrumbs for others (and your future self)
\item
  Create a data pipeline and DO NOT DESTROY UNDERLYING DATA-- build
\item
  Make assumptions, and document them!
\item
  Show AND tell your results
\end{itemize}

\chapter{Tidy Data}\label{tidy-data}

\section{Tidy Data, or Why you should clean your
room}\label{tidy-data-or-why-you-should-clean-your-room}

\section[Learning the Language of Tidy Data]{\texorpdfstring{Learning
the Language of Tidy Data\footnote{Adapted from Hadley Wickham's paper
  on \href{https://vita.had.co.nz/papers/tidy-data.pdf}{Tidy Data}}}{Learning the Language of Tidy Data}}\label{learning-the-language-of-tidy-data}

If you have ever typed a formula in excel, congrats! You are a
programmer. Embrace it! If you haven't, you will soon, and then you will
be a programmer too. Excel is the world's largest and most underrated
programming language. Now, you just have to embrace thinking
programmaticlly-- tidy. It's like grammar. There are rules so these
sentances (hopefully) make sense to you, the reader. Similarily, by
following common conventions of tidy data analysis, others will be able
to ``read'' your analysis like you are reading this sentance. And also,
like grammar, you can break the rules-- but it helps to know them first.

Here are a couple definitions that will help as you move through this
text. Don't worry about memorizing them, as I will refer back to these
definitions frequently.

\begin{itemize}
\tightlist
\item
  Fields

  \begin{itemize}
  \tightlist
  \item
    A field is a fancy name for a column. From here on out, every
    calculation, manipulation, formula, you name it, will be on a
    column. I want you to forget that you could ever modify a lone cell
    in Excel. No more formulas in cells. No more typing in values to a
    cell. Certainly no more writing over data in a cell. Democratic data
    analysis depends on formulas that work on entire fields. Everything
    you would need to do to a single cell in Excel can-- and should!--
    be done to an entire column. This will be immensly valuable, as you
    will hopefully see while working through this material.
  \end{itemize}
\item
  Variables

  \begin{itemize}
  \tightlist
  \item
    A variable is something in your data that can change. That's it!
    Variables become very important when looking at how to structure
    your data.
  \end{itemize}
\item
  Observations

  \begin{itemize}
  \tightlist
  \item
    Observations make up the rows of your dataset. Each observation
    should correspond to a specific ``thing.'' This will make more sense
    later, I promise.
  \end{itemize}
\item
  Values

  \begin{itemize}
  \tightlist
  \item
    Values are the actual data in your table. Each value belongs to 1
    (one) observation and 1 (one) variable.
  \end{itemize}
\item
  Table

  \begin{itemize}
  \tightlist
  \item
    A table is the grouping of all observations of a similar type.
  \end{itemize}
\end{itemize}

An example relevent to public administration might make this more clear.
Below is a table\footnote{Data was created for demonstration purposes}
that shows types of retirement visits for a month at a state's
Department of Retirement Services by the employee who took the visit and
the visit type.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}

\NormalTok{visits <-}\StringTok{ }\KeywordTok{tribble}\NormalTok{(}
  \OperatorTok{~}\StringTok{"Employee"}\NormalTok{, }\OperatorTok{~}\StringTok{"Phone Visits"}\NormalTok{, }\OperatorTok{~}\StringTok{"Office Visits"}\NormalTok{, }\OperatorTok{~}\StringTok{"Online Visits"}\NormalTok{,}
  \StringTok{"Danielle"}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{23}\NormalTok{,}
  \StringTok{"Ramona"}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{18}\NormalTok{,}
  \StringTok{"Ross"}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{10} 
\NormalTok{)}

\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(visits, }\DataTypeTok{caption =} \StringTok{"Visits to the Dept. of Retirement Services in a given month"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:tables-visits}Visits to the Dept. of Retirement Services in a given month}
\centering
\begin{tabular}[t]{l|r|r|r}
\hline
Employee & Phone Visits & Office Visits & Online Visits\\
\hline
Danielle & 6 & 11 & 23\\
\hline
Ramona & 11 & 5 & 18\\
\hline
Ross & 10 & 10 & 10\\
\hline
\end{tabular}
\end{table}

Data are frequently displayed in this ``wide'' format. It works great
for presentation, but not great for data analysis.

The shortcomings of data in this format may become apparent when you
attempt to work with the data in a pivot table. This is becuase our
columns aren't truly variables. You can drag the fields from the top row
to the grey box below, for columns, and the left, for rows. This becomes
unmanegable quickly.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rpivotTable}\OperatorTok{::}\KeywordTok{rpivotTable}\NormalTok{(visits, }\DataTypeTok{width =} \StringTok{"60%"}\NormalTok{, }\DataTypeTok{height =} \StringTok{"60%"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## PhantomJS not found. You can install it with webshot::install_phantomjs(). If it is installed, please make sure the phantomjs executable can be found via the PATH variable.
\end{verbatim}

\hypertarget{htmlwidget-44734aa92161ddd6c711}{}

Let's apply our criteria of tidy data to this set:

\begin{itemize}
\tightlist
\item
  Variables

  \begin{itemize}
  \tightlist
  \item
    At first glance, it doensn't look like this is a problem. But think
    again. Is \texttt{phone\ visits} really a variable? Or is the real
    variable of interest number of visits? And are our column names
    actually variables too (type of visit)?
  \end{itemize}
\end{itemize}

Let's take another swing at setting up our table for data analysis
purposes. This can be accomplished easily in R using the code below, or
in Excel by loading the data with \texttt{Get\ and\ Transform}
-\textgreater{} selecting the three ``visits'' columns -\textgreater{}
right clicking -\textgreater{} and selecting ``unpivot columns.''

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#We have already loaded the "tidyverse" library so we do not have to do it again}

\NormalTok{pivot_visits <-}\StringTok{ }\NormalTok{visits }\OperatorTok{%>%}\StringTok{ }\CommentTok{#we are editing the "visits" table already created by storing it in a new table pivot_visits}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\OperatorTok{-}\NormalTok{Employee, }\DataTypeTok{names_to =} \StringTok{"Visit Type"}\NormalTok{, }\DataTypeTok{values_to =} \StringTok{"Number of Visits"}\NormalTok{) }\CommentTok{#using pivot_longer on every column except "employee" and setting the name of the new columns}


\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(pivot_visits, }\DataTypeTok{caption =} \StringTok{"Visits to the Dept. of Retirement Services in a given month"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:unnamed-chunk-3}Visits to the Dept. of Retirement Services in a given month}
\centering
\begin{tabular}[t]{l|l|r}
\hline
Employee & Visit Type & Number of Visits\\
\hline
Danielle & Phone Visits & 6\\
\hline
Danielle & Office Visits & 11\\
\hline
Danielle & Online Visits & 23\\
\hline
Ramona & Phone Visits & 11\\
\hline
Ramona & Office Visits & 5\\
\hline
Ramona & Online Visits & 18\\
\hline
Ross & Phone Visits & 10\\
\hline
Ross & Office Visits & 10\\
\hline
Ross & Online Visits & 10\\
\hline
\end{tabular}
\end{table}

Now this is a table that is much easier to analyze in an Excel pivot
table or with a variety of R functions. Using data in this format, it is
easy to recreate the original table for presentation, while also giving
a variety of options for formatting and plotting. Use the pivot table
below to recreate the original table using the tidy data. *Hint- Instead
of Count, select Sum -\textgreater{} Number of Visits as the value
field. It is far easier to work with fields when they are in a tidy
format.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rpivotTable}\OperatorTok{::}\KeywordTok{rpivotTable}\NormalTok{(pivot_visits, }\DataTypeTok{width =} \StringTok{"60%"}\NormalTok{, }\DataTypeTok{height =} \StringTok{"400px"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{htmlwidget-c09c643864a402aa4f23}{}

When we get to the next chapter, you will learn several alternatives to
pivot tables that use the same principles, but are more reproducible.

\section{Using lower level data}\label{using-lower-level-data}

Let's introduce a slightly more complicated tidy data problem, using the
same base data as before.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visits_retirements <-}\StringTok{ }\KeywordTok{tribble}\NormalTok{(}
  \OperatorTok{~}\StringTok{"Employee"}\NormalTok{, }\OperatorTok{~}\StringTok{"Phone Visits"}\NormalTok{, }\OperatorTok{~}\StringTok{"Phone Retirements"}\NormalTok{, }\OperatorTok{~}\StringTok{"Office Visits"}\NormalTok{, }\OperatorTok{~}\StringTok{"Office Retirements"}\NormalTok{, }\OperatorTok{~}\StringTok{"Online Visits"}\NormalTok{, }\OperatorTok{~}\StringTok{"Online Retirements"}\NormalTok{,}
  \StringTok{"Danielle"}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{15}\NormalTok{,}
  \StringTok{"Ramona"}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{15}\NormalTok{,}
  \StringTok{"Ross"}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{9} 
\NormalTok{)}

\NormalTok{knitr}\OperatorTok{::}\KeywordTok{kable}\NormalTok{(visits_retirements, }\DataTypeTok{caption =} \StringTok{"Visits to the Dept. of Retirement Services in a given month by employee and associated client retirements"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:unnamed-chunk-5}Visits to the Dept. of Retirement Services in a given month by employee and associated client retirements}
\centering
\begin{tabular}[t]{l|r|r|r|r|r|r}
\hline
Employee & Phone Visits & Phone Retirements & Office Visits & Office Retirements & Online Visits & Online Retirements\\
\hline
Danielle & 6 & 4 & 11 & 8 & 23 & 15\\
\hline
Ramona & 11 & 7 & 5 & 3 & 18 & 15\\
\hline
Ross & 10 & 8 & 10 & 7 & 10 & 9\\
\hline
\end{tabular}
\end{table}

Hopefully you will see a similar pattern here. Now, there are three
variables: Visit type, number of visits, and number of retirements.
Again, this data works fine for presentation but could use tidying to
ease in analysis.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visits_retirements }\OperatorTok{%>%}
\StringTok{  }\NormalTok{DT}\OperatorTok{::}\KeywordTok{datatable}\NormalTok{(}
    \DataTypeTok{extensions =} \StringTok{'Buttons'}\NormalTok{, }
    \DataTypeTok{options =} \KeywordTok{list}\NormalTok{(}\DataTypeTok{dom =} \StringTok{'Bfrtip'}\NormalTok{, }
                   \DataTypeTok{buttons =} \StringTok{'excel'}\NormalTok{,}
                   \DataTypeTok{searching =} \OtherTok{FALSE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{htmlwidget-f2426f646a335847044c}{}

Try to tidy this in R or Excel Get and Transform. See this
footnote\footnote{powerquery hints} or look at the code if you need a
hint.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visits_retirements_tidy <-}\StringTok{ }\NormalTok{visits_retirements }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\DataTypeTok{cols =} \OperatorTok{-}\NormalTok{Employee, }
               \DataTypeTok{names_to =} \KeywordTok{c}\NormalTok{(}\StringTok{"Visit Location"}\NormalTok{, }\StringTok{"Type"}\NormalTok{), }
               \DataTypeTok{names_sep =} \StringTok{" "}\NormalTok{)}

\KeywordTok{print}\NormalTok{(visits_retirements_tidy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 18 x 4
##    Employee `Visit Location` Type        value
##    <chr>    <chr>            <chr>       <dbl>
##  1 Danielle Phone            Visits          6
##  2 Danielle Phone            Retirements     4
##  3 Danielle Office           Visits         11
##  4 Danielle Office           Retirements     8
##  5 Danielle Online           Visits         23
##  6 Danielle Online           Retirements    15
##  7 Ramona   Phone            Visits         11
##  8 Ramona   Phone            Retirements     7
##  9 Ramona   Office           Visits          5
## 10 Ramona   Office           Retirements     3
## 11 Ramona   Online           Visits         18
## 12 Ramona   Online           Retirements    15
## 13 Ross     Phone            Visits         10
## 14 Ross     Phone            Retirements     8
## 15 Ross     Office           Visits         10
## 16 Ross     Office           Retirements     7
## 17 Ross     Online           Visits         10
## 18 Ross     Online           Retirements     9
\end{verbatim}

In this case, we actually pivoted too far. It will probably be more
useful to have the counts of visits and retirements in their own
category. Keep in mind the scope of the observation-- It is perfectly
valid for each to have their own column, as it is visits and retirements
per month.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{visits_retirements_tidy2 <-}\StringTok{ }\NormalTok{visits_retirements_tidy }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{pivot_wider}\NormalTok{(}\DataTypeTok{id_cols =} \KeywordTok{c}\NormalTok{(Employee, }\StringTok{`}\DataTypeTok{Visit Location}\StringTok{`}\NormalTok{, Type), }\DataTypeTok{names_from =}\NormalTok{ Type, }\DataTypeTok{values_from =}\NormalTok{ value)}
\end{Highlighting}
\end{Shaded}

From here, it is easy to do calculations based on fields, rather than
cells.

\section{So how is this democratic?}\label{so-how-is-this-democratic}

\section{Practice problems}\label{practice-problems}

\chapter{Reproducible Analysis}\label{reproducible-analysis}

We describe our methods in this chapter.

\section{Make your life easier}\label{make-your-life-easier}

\chapter{Data Modeling}\label{data-modeling}

Some \emph{significant} applications are demonstrated in this chapter.

\section{Example one}\label{example-one}

\section{Example two}\label{example-two}

\section{Assumptions}\label{assumptions}

\chapter{Visualization}\label{visualization}

We have finished a nice book.

\chapter{Applications}\label{applications}

\chapter{Resources}\label{resources}

\bibliography{book.bib,packages.bib}

\end{document}
