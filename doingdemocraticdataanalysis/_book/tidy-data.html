<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Tidy Data | Doing Democratic Data Analysis</title>
  <meta name="description" content="An opinionated guide to data analysis for public administrators and policy analysts" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Tidy Data | Doing Democratic Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An opinionated guide to data analysis for public administrators and policy analysts" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Tidy Data | Doing Democratic Data Analysis" />
  
  <meta name="twitter:description" content="An opinionated guide to data analysis for public administrators and policy analysts" />
  

<meta name="author" content="Corban Nemeth" />


<meta name="date" content="2020-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="reproducible-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" />
<script src="libs/jquery-ui-1.11.4/jquery-ui.min.js"></script>
<script src="libs/jquery-ui-1.11.4/jquery.ui.touch-punch.min.js"></script>
<link href="libs/c3-0.4.11/c3.min.css" rel="stylesheet" />
<script src="libs/c3-0.4.11/c3.min.js"></script>
<script src="libs/d3-3.5.5/d3.v3.min.js"></script>
<link href="libs/pivottable-2.19.0/pivot.min.css" rel="stylesheet" />
<script src="libs/pivottable-2.19.0/pivot.min.js"></script>
<script src="libs/pivottable-2.19.0/d3_renderers.min.js"></script>
<script src="libs/pivottable-2.19.0/c3_renderers.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.cs.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.da.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.de.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.es.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.fr.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.it.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.nl.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.pl.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.pt.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.ru.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.sq.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.tr.min.js"></script>
<script src="libs/pivottable-2.19.0/pivot.zh.min.js"></script>
<link href="libs/subtotal-1.10.0/subtotal.min.css" rel="stylesheet" />
<script src="libs/subtotal-1.10.0/subtotal.min.js"></script>
<script src="libs/polyfill-0.1/polyfill.min.js"></script>
<link href="libs/rpivotTable_style-0.1/rpivotTable.css" rel="stylesheet" />
<script src="libs/rpivotTable-binding-0.3.0/rpivotTable.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.12/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.20/jszip.min.js"></script>
<link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Doing Democratic Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-is-this-guide-for"><i class="fa fa-check"></i>Who is this guide for?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-will-i-learn"><i class="fa fa-check"></i>What will I learn?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-democratic-data-analysis"><i class="fa fa-check"></i><b>1.1</b> What is democratic data analysis?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#do-i-need-to-be-an-excel-god-before-i-begin"><i class="fa fa-check"></i><b>1.2</b> Do I need to be an Excel god before I begin?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#what-tools-should-i-use"><i class="fa fa-check"></i><b>1.3</b> What tools should I use?</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.4</b> How to use this book</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#quickstart-guide-to-excel"><i class="fa fa-check"></i><b>1.5</b> Quickstart Guide to Excel</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#quickstart-guide-to-r"><i class="fa fa-check"></i><b>1.6</b> Quickstart Guide to R</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#how-to-think-about-democratic-data-analysis"><i class="fa fa-check"></i><b>1.7</b> How to Think about Democratic Data Analysis</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#alternate-forms-of-data-analysis"><i class="fa fa-check"></i><b>1.8</b> Alternate Forms of Data Analysis</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#oligarchic-data-analysis"><i class="fa fa-check"></i>Oligarchic Data Analysis</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#monarchic-data-analysis"><i class="fa fa-check"></i>Monarchic Data Analysis</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#dictitorial-data-analysis"><i class="fa fa-check"></i>Dictitorial Data Analysis</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#technocratic-data-analysis"><i class="fa fa-check"></i>Technocratic Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#principles-of-democratic-data-analysis"><i class="fa fa-check"></i><b>1.9</b> Principles of Democratic Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>2</b> Tidy Data</a><ul>
<li class="chapter" data-level="2.1" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-or-why-you-should-clean-your-room"><i class="fa fa-check"></i><b>2.1</b> Tidy Data, or Why you should clean your room</a></li>
<li class="chapter" data-level="2.2" data-path="tidy-data.html"><a href="tidy-data.html#learning-the-language-of-tidy-data"><i class="fa fa-check"></i><b>2.2</b> Learning the Language of Tidy Data</a></li>
<li class="chapter" data-level="2.3" data-path="tidy-data.html"><a href="tidy-data.html#using-lower-level-data"><i class="fa fa-check"></i><b>2.3</b> Using lower level data</a></li>
<li class="chapter" data-level="2.4" data-path="tidy-data.html"><a href="tidy-data.html#so-how-is-this-democratic"><i class="fa fa-check"></i><b>2.4</b> So how is this democratic?</a></li>
<li class="chapter" data-level="2.5" data-path="tidy-data.html"><a href="tidy-data.html#practice-problems"><i class="fa fa-check"></i><b>2.5</b> Practice problems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reproducible-analysis.html"><a href="reproducible-analysis.html"><i class="fa fa-check"></i><b>3</b> Reproducible Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="reproducible-analysis.html"><a href="reproducible-analysis.html#make-your-life-easier"><i class="fa fa-check"></i><b>3.1</b> Make your life easier</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-modeling.html"><a href="data-modeling.html"><i class="fa fa-check"></i><b>4</b> Data Modeling</a><ul>
<li class="chapter" data-level="4.1" data-path="data-modeling.html"><a href="data-modeling.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="data-modeling.html"><a href="data-modeling.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
<li class="chapter" data-level="4.3" data-path="data-modeling.html"><a href="data-modeling.html#assumptions"><i class="fa fa-check"></i><b>4.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5</b> Visualization</a></li>
<li class="chapter" data-level="6" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>6</b> Applications</a></li>
<li class="chapter" data-level="7" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>7</b> Resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Doing Democratic Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy-data" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Tidy Data</h1>
<div id="tidy-data-or-why-you-should-clean-your-room" class="section level2">
<h2><span class="header-section-number">2.1</span> Tidy Data, or Why you should clean your room</h2>
</div>
<div id="learning-the-language-of-tidy-data" class="section level2">
<h2><span class="header-section-number">2.2</span> Learning the Language of Tidy Data<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a></h2>
<p>If you have ever typed a formula in excel, congrats! You are a programmer. Embrace it! If you haven’t, you will soon, and then you will be a programmer too. Excel is the world’s largest and most underrated programming language. Now, you just have to embrace thinking programmaticlly– tidy. It’s like grammar. There are rules so these sentances (hopefully) make sense to you, the reader. Similarily, by following common conventions of tidy data analysis, others will be able to “read” your analysis like you are reading this sentance. And also, like grammar, you can break the rules– but it helps to know them first.</p>
<p>Here are a couple definitions that will help as you move through this text. Don’t worry about memorizing them, as I will refer back to these definitions frequently.</p>
<ul>
<li>Fields
<ul>
<li>A field is a fancy name for a column. From here on out, every calculation, manipulation, formula, you name it, will be on a column. I want you to forget that you could ever modify a lone cell in Excel. No more formulas in cells. No more typing in values to a cell. Certainly no more writing over data in a cell. Democratic data analysis depends on formulas that work on entire fields. Everything you would need to do to a single cell in Excel can– and should!– be done to an entire column. This will be immensly valuable, as you will hopefully see while working through this material.</li>
</ul></li>
<li>Variables
<ul>
<li>A variable is something in your data that can change. That’s it! Variables become very important when looking at how to structure your data.</li>
</ul></li>
<li>Observations
<ul>
<li>Observations make up the rows of your dataset. Each observation should correspond to a specific “thing.” This will make more sense later, I promise.</li>
</ul></li>
<li>Values
<ul>
<li>Values are the actual data in your table. Each value belongs to 1 (one) observation and 1 (one) variable.</li>
</ul></li>
<li>Table
<ul>
<li>A table is the grouping of all observations of a similar type.</li>
</ul></li>
</ul>
<p>An example relevent to public administration might make this more clear. Below is a table<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> that shows types of retirement visits for a month at a state’s Department of Retirement Services by the employee who took the visit and the visit type.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)

visits &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span><span class="st">&quot;Employee&quot;</span>, <span class="op">~</span><span class="st">&quot;Phone Visits&quot;</span>, <span class="op">~</span><span class="st">&quot;Office Visits&quot;</span>, <span class="op">~</span><span class="st">&quot;Online Visits&quot;</span>,
  <span class="st">&quot;Danielle&quot;</span>, <span class="dv">6</span>, <span class="dv">11</span>, <span class="dv">23</span>,
  <span class="st">&quot;Ramona&quot;</span>, <span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">18</span>,
  <span class="st">&quot;Ross&quot;</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span> 
)

knitr<span class="op">::</span><span class="kw">kable</span>(visits, <span class="dt">caption =</span> <span class="st">&quot;Visits to the Dept. of Retirement Services in a given month&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:tables-visits">Table 2.1: </span>Visits to the Dept. of Retirement Services in a given month</caption>
<thead>
<tr class="header">
<th align="left">Employee</th>
<th align="right">Phone Visits</th>
<th align="right">Office Visits</th>
<th align="right">Online Visits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Danielle</td>
<td align="right">6</td>
<td align="right">11</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">Ramona</td>
<td align="right">11</td>
<td align="right">5</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left">Ross</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>Data are frequently displayed in this “wide” format. It works great for presentation, but not great for data analysis.</p>
<p>The shortcomings of data in this format may become apparent when you attempt to work with the data in a pivot table. This is becuase our columns aren’t truly variables. You can drag the fields from the top row to the grey box below, for columns, and the left, for rows. This becomes unmanegable quickly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rpivotTable<span class="op">::</span><span class="kw">rpivotTable</span>(visits, <span class="dt">width =</span> <span class="st">&quot;60%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;60%&quot;</span>)</code></pre></div>
<div id="htmlwidget-53e8c29a91a895d44bae" style="width:60%;height:60%;" class="rpivotTable html-widget"></div>
<script type="application/json" data-for="htmlwidget-53e8c29a91a895d44bae">{"x":{"data":{"Employee":["Danielle","Ramona","Ross"],"Phone Visits":[6,11,10],"Office Visits":[11,5,10],"Online Visits":[23,18,10]},"params":{},"locale":"en","subtotals":false},"evals":[],"jsHooks":[]}</script>
<p>Let’s apply our criteria of tidy data to this set:</p>
<ul>
<li>Variables
<ul>
<li>At first glance, it doensn’t look like this is a problem. But think again. Is <code>phone visits</code> really a variable? Or is the real variable of interest number of visits? And are our column names actually variables too (type of visit)?</li>
</ul></li>
</ul>
<p>Let’s take another swing at setting up our table for data analysis purposes. This can be accomplished easily in R using the code below, or in Excel by loading the data with <code>Get and Transform</code> -&gt; selecting the three “visits” columns -&gt; right clicking -&gt; and selecting “unpivot columns.”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#We have already loaded the &quot;tidyverse&quot; library so we do not have to do it again</span>

pivot_visits &lt;-<span class="st"> </span>visits <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#we are editing the &quot;visits&quot; table already created by storing it in a new table pivot_visits</span>
<span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Employee, <span class="dt">names_to =</span> <span class="st">&quot;Visit Type&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Number of Visits&quot;</span>) <span class="co">#using pivot_longer on every column except &quot;employee&quot; and setting the name of the new columns</span>


knitr<span class="op">::</span><span class="kw">kable</span>(pivot_visits, <span class="dt">caption =</span> <span class="st">&quot;Visits to the Dept. of Retirement Services in a given month&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-3">Table 2.2: </span>Visits to the Dept. of Retirement Services in a given month</caption>
<thead>
<tr class="header">
<th align="left">Employee</th>
<th align="left">Visit Type</th>
<th align="right">Number of Visits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Danielle</td>
<td align="left">Phone Visits</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Danielle</td>
<td align="left">Office Visits</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">Danielle</td>
<td align="left">Online Visits</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">Ramona</td>
<td align="left">Phone Visits</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">Ramona</td>
<td align="left">Office Visits</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">Ramona</td>
<td align="left">Online Visits</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left">Ross</td>
<td align="left">Phone Visits</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">Ross</td>
<td align="left">Office Visits</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">Ross</td>
<td align="left">Online Visits</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>Now this is a table that is much easier to analyze in an Excel pivot table or with a variety of R functions. Using data in this format, it is easy to recreate the original table for presentation, while also giving a variety of options for formatting and plotting. Use the pivot table below to recreate the original table using the tidy data. *Hint- Instead of Count, select Sum -&gt; Number of Visits as the value field. It is far easier to work with fields when they are in a tidy format.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rpivotTable<span class="op">::</span><span class="kw">rpivotTable</span>(pivot_visits, <span class="dt">width =</span> <span class="st">&quot;60%&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;400px&quot;</span>)</code></pre></div>
<div id="htmlwidget-d2f656abd4c4241e1d47" style="width:60%;height:400px;" class="rpivotTable html-widget"></div>
<script type="application/json" data-for="htmlwidget-d2f656abd4c4241e1d47">{"x":{"data":{"Employee":["Danielle","Danielle","Danielle","Ramona","Ramona","Ramona","Ross","Ross","Ross"],"Visit Type":["Phone Visits","Office Visits","Online Visits","Phone Visits","Office Visits","Online Visits","Phone Visits","Office Visits","Online Visits"],"Number of Visits":[6,11,23,11,5,18,10,10,10]},"params":{},"locale":"en","subtotals":false},"evals":[],"jsHooks":[]}</script>
<p>When we get to the next chapter, you will learn several alternatives to pivot tables that use the same principles, but are more reproducible.</p>
</div>
<div id="using-lower-level-data" class="section level2">
<h2><span class="header-section-number">2.3</span> Using lower level data</h2>
<p>Let’s introduce a slightly more complicated tidy data problem, using the same base data as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">visits_retirements &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span><span class="st">&quot;Employee&quot;</span>, <span class="op">~</span><span class="st">&quot;Phone Visits&quot;</span>, <span class="op">~</span><span class="st">&quot;Phone Retirements&quot;</span>, <span class="op">~</span><span class="st">&quot;Office Visits&quot;</span>, <span class="op">~</span><span class="st">&quot;Office Retirements&quot;</span>, <span class="op">~</span><span class="st">&quot;Online Visits&quot;</span>, <span class="op">~</span><span class="st">&quot;Online Retirements&quot;</span>,
  <span class="st">&quot;Danielle&quot;</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">23</span>, <span class="dv">15</span>,
  <span class="st">&quot;Ramona&quot;</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">18</span>, <span class="dv">15</span>,
  <span class="st">&quot;Ross&quot;</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">9</span> 
)

knitr<span class="op">::</span><span class="kw">kable</span>(visits_retirements, <span class="dt">caption =</span> <span class="st">&quot;Visits to the Dept. of Retirement Services in a given month by employee and associated client retirements&quot;</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 2.3: </span>Visits to the Dept. of Retirement Services in a given month by employee and associated client retirements</caption>
<thead>
<tr class="header">
<th align="left">Employee</th>
<th align="right">Phone Visits</th>
<th align="right">Phone Retirements</th>
<th align="right">Office Visits</th>
<th align="right">Office Retirements</th>
<th align="right">Online Visits</th>
<th align="right">Online Retirements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Danielle</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">11</td>
<td align="right">8</td>
<td align="right">23</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">Ramona</td>
<td align="right">11</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">18</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">Ross</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">9</td>
</tr>
</tbody>
</table>
<p>Hopefully you will see a similar pattern here. Now, there are three variables: Visit type, number of visits, and number of retirements. Again, this data works fine for presentation but could use tidying to ease in analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">visits_retirements <span class="op">%&gt;%</span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(
    <span class="dt">extensions =</span> <span class="st">&#39;Buttons&#39;</span>, 
    <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">dom =</span> <span class="st">&#39;Bfrtip&#39;</span>, 
                   <span class="dt">buttons =</span> <span class="st">&#39;excel&#39;</span>,
                   <span class="dt">searching =</span> <span class="ot">FALSE</span>))</code></pre></div>
<div id="htmlwidget-fe59516e26f4a56c12e2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fe59516e26f4a56c12e2">{"x":{"filter":"none","extensions":["Buttons"],"data":[["1","2","3"],["Danielle","Ramona","Ross"],[6,11,10],[4,7,8],[11,5,10],[8,3,7],[23,18,10],[15,15,9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Employee<\/th>\n      <th>Phone Visits<\/th>\n      <th>Phone Retirements<\/th>\n      <th>Office Visits<\/th>\n      <th>Office Retirements<\/th>\n      <th>Online Visits<\/th>\n      <th>Online Retirements<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["excel"],"searching":false,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Try to tidy this in R or Excel Get and Transform. See this footnote<a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a> or look at the code if you need a hint.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">visits_retirements_tidy &lt;-<span class="st"> </span>visits_retirements <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>Employee, 
               <span class="dt">names_to =</span> <span class="kw">c</span>(<span class="st">&quot;Visit Location&quot;</span>, <span class="st">&quot;Type&quot;</span>), 
               <span class="dt">names_sep =</span> <span class="st">&quot; &quot;</span>)

<span class="kw">print</span>(visits_retirements_tidy)</code></pre></div>
<pre><code>## # A tibble: 18 x 4
##    Employee `Visit Location` Type        value
##    &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt;
##  1 Danielle Phone            Visits          6
##  2 Danielle Phone            Retirements     4
##  3 Danielle Office           Visits         11
##  4 Danielle Office           Retirements     8
##  5 Danielle Online           Visits         23
##  6 Danielle Online           Retirements    15
##  7 Ramona   Phone            Visits         11
##  8 Ramona   Phone            Retirements     7
##  9 Ramona   Office           Visits          5
## 10 Ramona   Office           Retirements     3
## 11 Ramona   Online           Visits         18
## 12 Ramona   Online           Retirements    15
## 13 Ross     Phone            Visits         10
## 14 Ross     Phone            Retirements     8
## 15 Ross     Office           Visits         10
## 16 Ross     Office           Retirements     7
## 17 Ross     Online           Visits         10
## 18 Ross     Online           Retirements     9</code></pre>
<p>In this case, we actually pivoted too far. It will probably be more useful to have the counts of visits and retirements in their own category. Keep in mind the scope of the observation– It is perfectly valid for each to have their own column, as it is visits and retirements per month.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">visits_retirements_tidy2 &lt;-<span class="st"> </span>visits_retirements_tidy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">id_cols =</span> <span class="kw">c</span>(Employee, <span class="st">`</span><span class="dt">Visit Location</span><span class="st">`</span>, Type), <span class="dt">names_from =</span> Type, <span class="dt">values_from =</span> value)</code></pre></div>
<p>From here, it is easy to do calculations based on fields, rather than cells.</p>
</div>
<div id="so-how-is-this-democratic" class="section level2">
<h2><span class="header-section-number">2.4</span> So how is this democratic?</h2>
</div>
<div id="practice-problems" class="section level2">
<h2><span class="header-section-number">2.5</span> Practice problems</h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Adapted from Hadley Wickham’s paper on <a href="https://vita.had.co.nz/papers/tidy-data.pdf">Tidy Data</a><a href="tidy-data.html#fnref4">↩</a></p></li>
<li id="fn5"><p>Data was created for demonstration purposes<a href="tidy-data.html#fnref5">↩</a></p></li>
<li id="fn6"><p>powerquery hints<a href="tidy-data.html#fnref6">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproducible-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["doingdemocraticdataanalysis.pdf", "doingdemocraticdataanalysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
